(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 13.3' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     15729,        347]
NotebookOptionsPosition[     14643,        322]
NotebookOutlinePosition[     15044,        338]
CellTagsIndexPosition[     15001,        335]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "ElGamal", " ", "Algorithm", " ", "Implementation", " ", "in", " ", 
    "Mathematica"}], "*)"}], 
  RowBox[{"(*", 
   RowBox[{
   "Given", " ", "prime", " ", "number", " ", "p", " ", "and", " ", 
    "generator", " ", "g"}], "*)"}], 
  RowBox[{
   RowBox[{
    RowBox[{
    "p", "=", 
     "323170060713110073001535134778251633624880571334890751745884341392698068\
341362100027920563626401646854585563579353308169288290230805734726252735547424\
612457410262025279165729728627063003252634282131457669314142236542209411113486\
299916574782680342305530863490506355577122191878903327295696961297438562417412\
362372251973464026918557977679768230146253979330580152268587307611975324364674\
758554607150438968449403661304976978128542959586595975670512838521327844685229\
255045682728791137200989318739591433741758378260002780349731985520606075332341\
22603254684088120031105907484281003994966956119696956248629032338072839127039"\
}], ";"}], "\n", 
   RowBox[{
    RowBox[{"g", "=", "2"}], ";"}], "\[IndentingNewLine]", "\n", 
   RowBox[{"(*", 
    RowBox[{"Key", " ", "Generation"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"a", "=", 
     RowBox[{"RandomInteger", "[", 
      RowBox[{"{", 
       RowBox[{"1", ",", 
        RowBox[{"p", "-", "2"}]}], "}"}], "]"}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{"A", "=", 
     RowBox[{"PowerMod", "[", 
      RowBox[{"g", ",", "a", ",", "p"}], "]"}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{"Print", "[", 
     RowBox[{"\"\<Public Key (A, p, g): \>\"", ",", 
      RowBox[{"{", 
       RowBox[{"A", ",", "p", ",", "g"}], "}"}]}], "]"}], ";"}], "\n", 
   RowBox[{
    RowBox[{"Print", "[", 
     RowBox[{"\"\<Private Key (a): \>\"", ",", "a"}], "]"}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Message", " ", "Conversion"}], "*)"}], "\n", 
   RowBox[{
    RowBox[{"m", "=", "\"\<Cara Alexandr\>\""}], ";"}], "\n", 
   RowBox[{
    RowBox[{"Print", "[", 
     RowBox[{"\"\<Original Message: \>\"", ",", "m"}], "]"}], ";"}], "\n", 
   RowBox[{
    RowBox[{"mInt", "=", 
     RowBox[{"FromDigits", "[", 
      RowBox[{
       RowBox[{"IntegerDigits", "[", 
        RowBox[{
         RowBox[{"ToCharacterCode", "[", "m", "]"}], ",", "256"}], "]"}], ",",
        "10"}], "]"}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{"Print", "[", 
     RowBox[{"\"\<Message as Integer: \>\"", ",", "mInt"}], "]"}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", "Encryption", "*)"}], "\n", 
   RowBox[{
    RowBox[{"k", "=", 
     RowBox[{"RandomInteger", "[", 
      RowBox[{"{", 
       RowBox[{"1", ",", 
        RowBox[{"p", "-", "2"}]}], "}"}], "]"}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{"C1", "=", 
     RowBox[{"PowerMod", "[", 
      RowBox[{"g", ",", "k", ",", "p"}], "]"}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{"C2", "=", 
     RowBox[{"Mod", "[", 
      RowBox[{
       RowBox[{"mInt", "*", 
        RowBox[{"PowerMod", "[", 
         RowBox[{"A", ",", "k", ",", "p"}], "]"}]}], ",", "p"}], "]"}]}], 
    ";"}], "\n", 
   RowBox[{
    RowBox[{"Print", "[", 
     RowBox[{"\"\<Encrypted Message: \>\"", ",", 
      RowBox[{"{", 
       RowBox[{"C1", ",", "C2"}], "}"}]}], "]"}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", "Decryption", "*)"}], "\n", 
   RowBox[{
    RowBox[{"mDecryptedInt", "=", 
     RowBox[{"Mod", "[", 
      RowBox[{
       RowBox[{"C2", "*", 
        RowBox[{"PowerMod", "[", 
         RowBox[{"C1", ",", 
          RowBox[{"p", "-", "1", "-", "a"}], ",", "p"}], "]"}]}], ",", "p"}], 
      "]"}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{"mDecrypted", "=", 
     RowBox[{"FromCharacterCode", "[", 
      RowBox[{"IntegerDigits", "[", 
       RowBox[{"mDecryptedInt", ",", "256"}], "]"}], "]"}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{"Print", "[", 
     RowBox[{"\"\<Decrypted Message as Integer: \>\"", ",", "mDecryptedInt"}],
      "]"}], ";"}], "\n", 
   RowBox[{
    RowBox[{"Print", "[", 
     RowBox[{"\"\<Decrypted Message: \>\"", ",", "mDecrypted"}], "]"}], ";"}],
    "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", "Verification", "*)"}], "\n", 
   RowBox[{
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{"m", "==", "mDecrypted"}], ",", 
      RowBox[{
      "Print", "[", 
       "\"\<ElGamal Test Passed: Decrypted message matches the original.\>\"",
        "]"}], ",", 
      RowBox[{
      "Print", "[", 
       "\"\<ElGamal Test Failed: Decrypted message does not match the \
original.\>\"", "]"}]}], "]"}], ";"}], "\n"}]}]], "Input",
 CellChangeTimes->{{3.909539732710216*^9, 3.9095397483815064`*^9}},
 CellLabel->"In[50]:=",ExpressionUUID->"b97a9012-e126-438f-9e70-e1ef73ed5307"],

Cell[CellGroupData[{

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Public Key (A, p, g): \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{
    "1733890681880897505914620846589189575126648816914537681768404367532470371\
971115171605609817239441103995771120288384956727292456599581696443886167702433\
265531621085894184732585342947061404170119766820719674117684362528003036480662\
387490041361428155149731749522681178836405624580935284489640784941955923270846\
540308274812899220430280353053215501801279673080935219179940029728971949191060\
775055030832353749270911013700546507315149645674274027808211642457976097921042\
926516456282473447012245136199431003736748262098023941320462857483585242184451\
6166652381637724665505586430830435067672155040003440689597699375798142624811",
      ",", "323170060713110073001535134778251633624880571334890751745884341392\
698068341362100027920563626401646854585563579353308169288290230805734726252735\
547424612457410262025279165729728627063003252634282131457669314142236542209411\
113486299916574782680342305530863490506355577122191878903327295696961297438562\
417412362372251973464026918557977679768230146253979330580152268587307611975324\
364674758554607150438968449403661304976978128542959586595975670512838521327844\
685229255045682728791137200989318739591433741758378260002780349731985520606075\
332341226032546840881200311059074842810039949669561196969562486290323380728391\
27039", ",", "2"}], "}"}]}],
  SequenceForm[
  "Public Key (A, p, g): ", {
   173389068188089750591462084658918957512664881691453768176840436753247037197\
111517160560981723944110399577112028838495672729245659958169644388616770243326\
553162108589418473258534294706140417011976682071967411768436252800303648066238\
749004136142815514973174952268117883640562458093528448964078494195592327084654\
030827481289922043028035305321550180127967308093521917994002972897194919106077\
505503083235374927091101370054650731514964567427402780821164245797609792104292\
651645628247344701224513619943100373674826209802394132046285748358524218445161\
66652381637724665505586430830435067672155040003440689597699375798142624811, 
    32317006071311007300153513477825163362488057133489075174588434139269806834\
136210002792056362640164685458556357935330816928829023080573472625273554742461\
245741026202527916572972862706300325263428213145766931414223654220941111348629\
991657478268034230553086349050635557712219187890332729569696129743856241741236\
237225197346402691855797767976823014625397933058015226858730761197532436467475\
855460715043896844940366130497697812854295958659597567051283852132784468522925\
504568272879113720098931873959143374175837826000278034973198552060607533234122\
603254684088120031105907484281003994966956119696956248629032338072839127039, 
    2}],
  Editable->False]], "Print",
 CellChangeTimes->{{3.9095397355444794`*^9, 3.909539750910041*^9}},
 CellLabel->
  "During evaluation of \
In[50]:=",ExpressionUUID->"389531c2-d529-4e2d-8062-740a684f059d"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Private Key (a): \"\>", "\[InvisibleSpace]", 
   "20930162923083845184927240917093050066363287173221256315467029235083145849\
264494367406386874843106618996100294233988845186756097872370899454236701917318\
761163383581015009146527841317227817923748113683301983565238863484241712421154\
160135326677744598819451213671729017871737857442215688732426087107838622297201\
032059604661998191103918026559190203276380484618677339448227396874031369259794\
950998972141882072118130401536685759489212947983163640547136302021947451913459\
517983759539723350929033296947638629749875282258283131679012773793333969051969\
488558587949076491420602677159404836536710821285933125220156308469656823085"}],
  SequenceForm[
  "Private Key (a): ", 
   209301629230838451849272409170930500663632871732212563154670292350831458492\
644943674063868748431066189961002942339888451867560978723708994542367019173187\
611633835810150091465278413172278179237481136833019835652388634842417124211541\
601353266777445988194512136717290178717378574422156887324260871078386222972010\
320596046619981911039180265591902032763804846186773394482273968740313692597949\
509989721418820721181304015366857594892129479831636405471363020219474519134595\
179837595397233509290332969476386297498752822582831316790127737933339690519694\
88558587949076491420602677159404836536710821285933125220156308469656823085],
  Editable->False]], "Print",
 CellChangeTimes->{{3.9095397355444794`*^9, 3.909539750917046*^9}},
 CellLabel->
  "During evaluation of \
In[50]:=",ExpressionUUID->"31b7e3c8-6cdd-4fdf-bdb9-c9aebf4fcc92"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Original Message: \"\>", 
   "\[InvisibleSpace]", "\<\"Cara Alexandr\"\>"}],
  SequenceForm["Original Message: ", "Cara Alexandr"],
  Editable->False]], "Print",
 CellChangeTimes->{{3.9095397355444794`*^9, 3.9095397509258366`*^9}},
 CellLabel->
  "During evaluation of \
In[50]:=",ExpressionUUID->"a1760928-ed95-4eab-8549-e048d9639b3c"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Message as Integer: \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", "77940969409114", "}"}]}],
  SequenceForm["Message as Integer: ", {77940969409114}],
  Editable->False]], "Print",
 CellChangeTimes->{{3.9095397355444794`*^9, 3.9095397509288654`*^9}},
 CellLabel->
  "During evaluation of \
In[50]:=",ExpressionUUID->"4a428bb7-07f5-4761-a14b-27d8a8385995"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Encrypted Message: \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{
    "2889160926508456366506750341896636401577972575394529078356679269977577336\
040471921136624053329009931621511596031116399993555877105347554019724401830557\
279256251165900892490618012916461000500016228178689247308461212002078737106108\
494429906770166674412122130951634626780232086514638965720530639428356454776249\
959806348234593001373606374379990296134401193156841710343994533188280161860201\
885485955584592797143398813873875112845023073937571436271323538023263362284263\
378779497218949463201157345126790681856740262720635695318183269218613342253020\
290263320014111620035555841074978910761031597230931264802229649993108684809", 
     ",", 
     RowBox[{
     "{", "2780541819393289589163851510919817384910109019908296803503133647914\
471502856131092557381110346259460698100046650333924878689042645450280740178857\
739166803138510555964721793834336068048137853019356335826745234867947945648730\
650025111852450535197565615913617512334853447039481998271711052325340566598783\
220428276065232274710855603262397912170239877217564382394231103765544500412730\
611033737079895719481590473263684958271251171591130758748107019667462870388067\
190120662203518727334546371675180954303610853782365317679854019859929795734527\
275464301171646004943959662287614227523598877236828059337570239007116401455430\
712", "}"}]}], "}"}]}],
  SequenceForm[
  "Encrypted Message: ", {
   288916092650845636650675034189663640157797257539452907835667926997757733604\
047192113662405332900993162151159603111639999355587710534755401972440183055727\
925625116590089249061801291646100050001622817868924730846121200207873710610849\
442990677016667441212213095163462678023208651463896572053063942835645477624995\
980634823459300137360637437999029613440119315684171034399453318828016186020188\
548595558459279714339881387387511284502307393757143627132353802326336228426337\
877949721894946320115734512679068185674026272063569531818326921861334225302029\
0263320014111620035555841074978910761031597230931264802229649993108684809, {
    27805418193932895891638515109198173849101090199082968035031336479144715028\
561310925573811103462594606981000466503339248786890426454502807401788577391668\
031385105559647217938343360680481378530193563358267452348679479456487306500251\
118524505351975656159136175123348534470394819982717110523253405665987832204282\
760652322747108556032623979121702398772175643823942311037655445004127306110337\
370798957194815904732636849582712511715911307587481070196674628703880671901206\
622035187273345463716751809543036108537823653176798540198599297957345272754643\
01171646004943959662287614227523598877236828059337570239007116401455430712}}],
  Editable->False]], "Print",
 CellChangeTimes->{{3.9095397355444794`*^9, 3.90953975093387*^9}},
 CellLabel->
  "During evaluation of \
In[50]:=",ExpressionUUID->"7c9d9505-d308-42c9-b810-49dda512b653"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Decrypted Message as Integer: \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", "77940969409114", "}"}]}],
  SequenceForm["Decrypted Message as Integer: ", {77940969409114}],
  Editable->False]], "Print",
 CellChangeTimes->{{3.9095397355444794`*^9, 3.9095397509382353`*^9}},
 CellLabel->
  "During evaluation of \
In[50]:=",ExpressionUUID->"09116d04-e241-4b3f-84ef-cc9d23b4ba2e"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Decrypted Message: \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", "\<\"F\[ATilde]\.0b\[CapitalEDoubleDot]\.8aZ\"\>", "}"}]}],
  SequenceForm[
  "Decrypted Message: ", {"F\[ATilde]\.0b\[CapitalEDoubleDot]\.8aZ"}],
  Editable->False]], "Print",
 CellChangeTimes->{{3.9095397355444794`*^9, 3.9095397509423327`*^9}},
 CellLabel->
  "During evaluation of \
In[50]:=",ExpressionUUID->"e5b2aa0a-dc0d-4b06-bc25-d24625dc25d7"]
}, Open  ]]
}, Open  ]]
},
WindowSize->{1141.2, 568.8},
WindowMargins->{{0, Automatic}, {Automatic, 0}},
FrontEndVersion->"13.3 for Microsoft Windows (64-bit) (July 24, 2023)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"ad9b2e38-698a-4700-a6cc-72d814d262a4"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 4758, 127, 714, "Input",ExpressionUUID->"b97a9012-e126-438f-9e70-e1ef73ed5307"],
Cell[CellGroupData[{
Cell[5363, 153, 2970, 45, 198, "Print",ExpressionUUID->"389531c2-d529-4e2d-8062-740a684f059d"],
Cell[8336, 200, 1614, 25, 110, "Print",ExpressionUUID->"31b7e3c8-6cdd-4fdf-bdb9-c9aebf4fcc92"],
Cell[9953, 227, 385, 9, 22, "Print",ExpressionUUID->"a1760928-ed95-4eab-8549-e048d9639b3c"],
Cell[10341, 238, 403, 9, 22, "Print",ExpressionUUID->"4a428bb7-07f5-4761-a14b-27d8a8385995"],
Cell[10747, 249, 2975, 46, 198, "Print",ExpressionUUID->"7c9d9505-d308-42c9-b810-49dda512b653"],
Cell[13725, 297, 423, 9, 22, "Print",ExpressionUUID->"09116d04-e241-4b3f-84ef-cc9d23b4ba2e"],
Cell[14151, 308, 464, 10, 25, "Print",ExpressionUUID->"e5b2aa0a-dc0d-4b06-bc25-d24625dc25d7"]
}, Open  ]]
}, Open  ]]
}
]
*)

